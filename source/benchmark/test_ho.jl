import Pkg 
Pkg.activate("./")

using Test

# Import the new versions
include("../Develop/Hamiltonian_creation.jl")
import .HamiltonianCreation_Develop as hc_dv
include("../Develop/Diagonalization.jl")
import .Diagonalization_t as diag_dv


@testset "Basis creation single species bosonic n=6, M=10" begin
    # Define parameters
    n = 6
    M = 10
    # Create basis for bosons
    basis, dict_basis = hc_dv.do_basis([n], M, "bose")
    # Check if the results are correct

    # Both lengths should be equal
    @test length(basis)/n == length(dict_basis)
    # The sum of the elements in each row of the basis should be less than M + n
    @test sum(M + n .> [sum(basis[i,:]) for i in 1:length(dict_basis)]) == length(dict_basis)

    truth = [1 1 1 1 1 1; 2 1 1 1 1 1; 2 2 1 1 1 1; 2 2 2 1 1 1; 2 2 2 2 1 1; 2 2 2 2 2 1; 2 2 2 2 2 2; 3 1 1 1 1 1; 3 2 1 1 1 1; 3 2 2 1 1 1; 3 2 2 2 1 1; 3 2 2 2 2 1; 3 2 2 2 2 2; 3 3 1 1 1 1; 3 3 2 1 1 1; 3 3 2 2 1 1; 3 3 2 2 2 1; 3 3 2 2 2 2; 3 3 3 1 1 1; 3 3 3 2 1 1; 3 3 3 2 2 1; 3 3 3 2 2 2; 3 3 3 3 1 1; 3 3 3 3 2 1; 4 1 1 1 1 1; 4 2 1 1 1 1; 4 2 2 1 1 1; 4 2 2 2 1 1; 4 2 2 2 2 1; 4 2 2 2 2 2; 4 3 1 1 1 1; 4 3 2 1 1 1; 4 3 2 2 1 1; 4 3 2 2 2 1; 4 3 2 2 2 2; 4 3 3 1 1 1; 4 3 3 2 1 1; 4 3 3 2 2 1; 4 3 3 3 1 1; 4 4 1 1 1 1; 4 4 2 1 1 1; 4 4 2 2 1 1; 4 4 2 2 2 1; 4 4 3 1 1 1; 4 4 3 2 1 1; 4 4 4 1 1 1; 5 1 1 1 1 1; 5 2 1 1 1 1; 5 2 2 1 1 1; 5 2 2 2 1 1; 5 2 2 2 2 1; 5 2 2 2 2 2; 5 3 1 1 1 1; 5 3 2 1 1 1; 5 3 2 2 1 1; 5 3 2 2 2 1; 5 3 3 1 1 1; 5 3 3 2 1 1; 5 4 1 1 1 1; 5 4 2 1 1 1; 5 4 2 2 1 1; 5 4 3 1 1 1; 5 5 1 1 1 1; 5 5 2 1 1 1; 6 1 1 1 1 1; 6 2 1 1 1 1; 6 2 2 1 1 1; 6 2 2 2 1 1; 6 2 2 2 2 1; 6 3 1 1 1 1; 6 3 2 1 1 1; 6 3 2 2 1 1; 6 3 3 1 1 1; 6 4 1 1 1 1; 6 4 2 1 1 1; 6 5 1 1 1 1; 7 1 1 1 1 1; 7 2 1 1 1 1; 7 2 2 1 1 1; 7 2 2 2 1 1; 7 3 1 1 1 1; 7 3 2 1 1 1; 7 4 1 1 1 1; 8 1 1 1 1 1; 8 2 1 1 1 1; 8 2 2 1 1 1; 8 3 1 1 1 1; 9 1 1 1 1 1; 9 2 1 1 1 1; 10 1 1 1 1 1]
    dict_truth = Dict([3, 3, 2, 2, 1, 1] => 16, [4, 4, 2, 1, 1, 1] => 41, [8, 1, 1, 1, 1, 1] => 84, [5, 5, 2, 1, 1, 1] => 64, [5, 4, 1, 1, 1, 1] => 59, [8, 2, 2, 1, 1, 1] => 86, [4, 2, 2, 2, 1, 1] => 28, [3, 3, 2, 2, 2, 1] => 17, [7, 4, 1, 1, 1, 1] => 83, [4, 4, 4, 1, 1, 1] => 46, [3, 3, 3, 1, 1, 1] => 19, [4, 2, 2, 2, 2, 1] => 29, [2, 2, 1, 1, 1, 1] => 3, [6, 2, 1, 1, 1, 1] => 66, [2, 2, 2, 2, 2, 2] => 7, [1, 1, 1, 1, 1, 1] => 1, [3, 3, 2, 1, 1, 1] => 15, [4, 1, 1, 1, 1, 1] => 25, [4, 3, 3, 2, 1, 1] => 37, [4, 2, 2, 1, 1, 1] => 27, [5, 2, 1, 1, 1, 1] => 48, [4, 3, 3, 2, 2, 1] => 38, [7, 2, 1, 1, 1, 1] => 78, [5, 2, 2, 2, 2, 2] => 52, [4, 3, 2, 2, 1, 1] => 33, [4, 3, 2, 2, 2, 1] => 34, [4, 3, 3, 1, 1, 1] => 36, [5, 4, 2, 2, 1, 1] => 61, [6, 3, 1, 1, 1, 1] => 70, [9, 1, 1, 1, 1, 1] => 88, [4, 3, 2, 1, 1, 1] => 32, [6, 4, 2, 1, 1, 1] => 75, [6, 5, 1, 1, 1, 1] => 76, [2, 2, 2, 2, 1, 1] => 5, [3, 2, 1, 1, 1, 1] => 9, [5, 3, 1, 1, 1, 1] => 53, [5, 4, 3, 1, 1, 1] => 62, [6, 2, 2, 2, 1, 1] => 68, [7, 3, 1, 1, 1, 1] => 81, [3, 2, 2, 2, 2, 2] => 13, [2, 2, 2, 2, 2, 1] => 6, [4, 4, 1, 1, 1, 1] => 40, [5, 4, 2, 1, 1, 1] => 60, [5, 5, 1, 1, 1, 1] => 63, [6, 2, 2, 2, 2, 1] => 69, [8, 2, 1, 1, 1, 1] => 85, [5, 2, 2, 2, 1, 1] => 50, [7, 2, 2, 2, 1, 1] => 80, [2, 1, 1, 1, 1, 1] => 2, [2, 2, 2, 1, 1, 1] => 4, [5, 2, 2, 2, 2, 1] => 51, [3, 3, 3, 3, 1, 1] => 23, [6, 1, 1, 1, 1, 1] => 65, [3, 3, 3, 2, 2, 2] => 22, [6, 2, 2, 1, 1, 1] => 67, [10, 1, 1, 1, 1, 1] => 90, [3, 3, 1, 1, 1, 1] => 14, [3, 3, 3, 3, 2, 1] => 24, [6, 3, 2, 2, 1, 1] => 72, [3, 3, 2, 2, 2, 2] => 18, [5, 1, 1, 1, 1, 1] => 47, [5, 3, 3, 2, 1, 1] => 58, [4, 2, 1, 1, 1, 1] => 26, [5, 2, 2, 1, 1, 1] => 49, [7, 1, 1, 1, 1, 1] => 77, [4, 2, 2, 2, 2, 2] => 30, [7, 2, 2, 1, 1, 1] => 79, [8, 3, 1, 1, 1, 1] => 87, [4, 4, 3, 2, 1, 1] => 45, [3, 2, 2, 2, 1, 1] => 11, [5, 3, 2, 2, 1, 1] => 55, [6, 3, 3, 1, 1, 1] => 73, [3, 2, 2, 2, 2, 1] => 12, [5, 3, 2, 2, 2, 1] => 56, [4, 4, 2, 2, 1, 1] => 42, [6, 3, 2, 1, 1, 1] => 71, [5, 3, 3, 1, 1, 1] => 57, [4, 3, 3, 3, 1, 1] => 39, [9, 2, 1, 1, 1, 1] => 89, [4, 4, 2, 2, 2, 1] => 43, [3, 1, 1, 1, 1, 1] => 8, [3, 3, 3, 2, 1, 1] => 20, [4, 4, 3, 1, 1, 1] => 44, [4, 3, 1, 1, 1, 1] => 31, [3, 2, 2, 1, 1, 1] => 10, [5, 3, 2, 1, 1, 1] => 54, [6, 4, 1, 1, 1, 1] => 74, [4, 3, 2, 2, 2, 2] => 35, [7, 3, 2, 1, 1, 1] => 82, [3, 3, 3, 2, 2, 1] => 21)

    @test basis == truth
    @test dict_basis == dict_truth
end

@testset "Basis creation two species bosonic n1=6 n2=2, M=10" begin
    # Define parameters
    n1 = 6
    n2 = 2
    M = 10
    # Create basis for bosons
    basis, dict_basis = hc_dv.do_basis([n1, n2], M, "bose")
    # Check if the results are correct

    # Both lengths should be equal
    @test length(basis)/(n1+n2) == length(dict_basis)

    truth = [2 2 1 1 1 1 1 1; 4 2 1 1 1 1 1 1; 4 4 1 1 1 1 1 1; 6 2 1 1 1 1 1 1; 6 4 1 1 1 1 1 1; 6 6 1 1 1 1 1 1; 8 2 1 1 1 1 1 1; 8 4 1 1 1 1 1 1; 8 6 1 1 1 1 1 1; 8 8 1 1 1 1 1 1; 10 2 1 1 1 1 1 1; 10 4 1 1 1 1 1 1; 10 6 1 1 1 1 1 1; 10 8 1 1 1 1 1 1; 10 10 1 1 1 1 1 1; 12 2 1 1 1 1 1 1; 12 4 1 1 1 1 1 1; 12 6 1 1 1 1 1 1; 12 8 1 1 1 1 1 1; 12 10 1 1 1 1 1 1; 14 2 1 1 1 1 1 1; 14 4 1 1 1 1 1 1; 14 6 1 1 1 1 1 1; 14 8 1 1 1 1 1 1; 16 2 1 1 1 1 1 1; 16 4 1 1 1 1 1 1; 16 6 1 1 1 1 1 1; 18 2 1 1 1 1 1 1; 18 4 1 1 1 1 1 1; 20 2 1 1 1 1 1 1; 3 2 2 1 1 1 1 1; 4 3 2 1 1 1 1 1; 4 4 3 1 1 1 1 1; 6 3 2 1 1 1 1 1; 6 4 3 1 1 1 1 1; 6 6 3 1 1 1 1 1; 8 3 2 1 1 1 1 1; 8 4 3 1 1 1 1 1; 8 6 3 1 1 1 1 1; 8 8 3 1 1 1 1 1; 10 3 2 1 1 1 1 1; 10 4 3 1 1 1 1 1; 10 6 3 1 1 1 1 1; 10 8 3 1 1 1 1 1; 10 10 3 1 1 1 1 1; 12 3 2 1 1 1 1 1; 12 4 3 1 1 1 1 1; 12 6 3 1 1 1 1 1; 12 8 3 1 1 1 1 1; 14 3 2 1 1 1 1 1; 14 4 3 1 1 1 1 1; 14 6 3 1 1 1 1 1; 16 3 2 1 1 1 1 1; 16 4 3 1 1 1 1 1; 18 3 2 1 1 1 1 1; 3 3 2 2 1 1 1 1; 4 3 3 2 1 1 1 1; 4 4 3 3 1 1 1 1; 6 3 3 2 1 1 1 1; 6 4 3 3 1 1 1 1; 6 6 3 3 1 1 1 1; 8 3 3 2 1 1 1 1; 8 4 3 3 1 1 1 1; 8 6 3 3 1 1 1 1; 8 8 3 3 1 1 1 1; 10 3 3 2 1 1 1 1; 10 4 3 3 1 1 1 1; 10 6 3 3 1 1 1 1; 10 8 3 3 1 1 1 1; 12 3 3 2 1 1 1 1; 12 4 3 3 1 1 1 1; 12 6 3 3 1 1 1 1; 14 3 3 2 1 1 1 1; 14 4 3 3 1 1 1 1; 16 3 3 2 1 1 1 1; 3 3 3 2 2 1 1 1; 4 3 3 3 2 1 1 1; 4 4 3 3 3 1 1 1; 6 3 3 3 2 1 1 1; 6 4 3 3 3 1 1 1; 6 6 3 3 3 1 1 1; 8 3 3 3 2 1 1 1; 8 4 3 3 3 1 1 1; 8 6 3 3 3 1 1 1; 8 8 3 3 3 1 1 1; 10 3 3 3 2 1 1 1; 10 4 3 3 3 1 1 1; 10 6 3 3 3 1 1 1; 12 3 3 3 2 1 1 1; 12 4 3 3 3 1 1 1; 14 3 3 3 2 1 1 1; 3 3 3 3 2 2 1 1; 4 3 3 3 3 2 1 1; 4 4 3 3 3 3 1 1; 6 3 3 3 3 2 1 1; 6 4 3 3 3 3 1 1; 6 6 3 3 3 3 1 1; 8 3 3 3 3 2 1 1; 8 4 3 3 3 3 1 1; 8 6 3 3 3 3 1 1; 10 3 3 3 3 2 1 1; 10 4 3 3 3 3 1 1; 12 3 3 3 3 2 1 1; 3 3 3 3 3 2 2 1; 4 3 3 3 3 3 2 1; 4 4 3 3 3 3 3 1; 6 3 3 3 3 3 2 1; 6 4 3 3 3 3 3 1; 6 6 3 3 3 3 3 1; 8 3 3 3 3 3 2 1; 8 4 3 3 3 3 3 1; 10 3 3 3 3 3 2 1; 3 3 3 3 3 3 2 2; 4 3 3 3 3 3 3 2; 4 4 3 3 3 3 3 3; 6 3 3 3 3 3 3 2; 6 4 3 3 3 3 3 3; 8 3 3 3 3 3 3 2; 5 2 2 1 1 1 1 1; 5 4 2 1 1 1 1 1; 5 4 4 1 1 1 1 1; 6 5 2 1 1 1 1 1; 6 5 4 1 1 1 1 1; 6 6 5 1 1 1 1 1; 8 5 2 1 1 1 1 1; 8 5 4 1 1 1 1 1; 8 6 5 1 1 1 1 1; 8 8 5 1 1 1 1 1; 10 5 2 1 1 1 1 1; 10 5 4 1 1 1 1 1; 10 6 5 1 1 1 1 1; 10 8 5 1 1 1 1 1; 12 5 2 1 1 1 1 1; 12 5 4 1 1 1 1 1; 12 6 5 1 1 1 1 1; 14 5 2 1 1 1 1 1; 14 5 4 1 1 1 1 1; 16 5 2 1 1 1 1 1; 5 3 2 2 1 1 1 1; 5 4 3 2 1 1 1 1; 5 4 4 3 1 1 1 1; 6 5 3 2 1 1 1 1; 6 5 4 3 1 1 1 1; 6 6 5 3 1 1 1 1; 8 5 3 2 1 1 1 1; 8 5 4 3 1 1 1 1; 8 6 5 3 1 1 1 1; 8 8 5 3 1 1 1 1; 10 5 3 2 1 1 1 1; 10 5 4 3 1 1 1 1; 10 6 5 3 1 1 1 1; 12 5 3 2 1 1 1 1; 12 5 4 3 1 1 1 1; 14 5 3 2 1 1 1 1; 5 3 3 2 2 1 1 1; 5 4 3 3 2 1 1 1; 5 4 4 3 3 1 1 1; 6 5 3 3 2 1 1 1; 6 5 4 3 3 1 1 1; 6 6 5 3 3 1 1 1; 8 5 3 3 2 1 1 1; 8 5 4 3 3 1 1 1; 8 6 5 3 3 1 1 1; 10 5 3 3 2 1 1 1; 10 5 4 3 3 1 1 1; 12 5 3 3 2 1 1 1; 5 3 3 3 2 2 1 1; 5 4 3 3 3 2 1 1; 5 4 4 3 3 3 1 1; 6 5 3 3 3 2 1 1; 6 5 4 3 3 3 1 1; 6 6 5 3 3 3 1 1; 8 5 3 3 3 2 1 1; 8 5 4 3 3 3 1 1; 10 5 3 3 3 2 1 1; 5 3 3 3 3 2 2 1; 5 4 3 3 3 3 2 1; 5 4 4 3 3 3 3 1; 6 5 3 3 3 3 2 1; 6 5 4 3 3 3 3 1; 8 5 3 3 3 3 2 1; 5 3 3 3 3 3 2 2; 5 4 3 3 3 3 3 2; 5 4 4 3 3 3 3 3; 6 5 3 3 3 3 3 2; 5 5 2 2 1 1 1 1; 5 5 4 2 1 1 1 1; 5 5 4 4 1 1 1 1; 6 5 5 2 1 1 1 1; 6 5 5 4 1 1 1 1; 6 6 5 5 1 1 1 1; 8 5 5 2 1 1 1 1; 8 5 5 4 1 1 1 1; 8 6 5 5 1 1 1 1; 10 5 5 2 1 1 1 1; 10 5 5 4 1 1 1 1; 12 5 5 2 1 1 1 1; 5 5 3 2 2 1 1 1; 5 5 4 3 2 1 1 1; 5 5 4 4 3 1 1 1; 6 5 5 3 2 1 1 1; 6 5 5 4 3 1 1 1; 6 6 5 5 3 1 1 1; 8 5 5 3 2 1 1 1; 8 5 5 4 3 1 1 1; 10 5 5 3 2 1 1 1; 5 5 3 3 2 2 1 1; 5 5 4 3 3 2 1 1; 5 5 4 4 3 3 1 1; 6 5 5 3 3 2 1 1; 6 5 5 4 3 3 1 1; 8 5 5 3 3 2 1 1; 5 5 3 3 3 2 2 1; 5 5 4 3 3 3 2 1; 5 5 4 4 3 3 3 1; 6 5 5 3 3 3 2 1; 5 5 3 3 3 3 2 2; 5 5 4 3 3 3 3 2; 5 5 5 2 2 1 1 1; 5 5 5 4 2 1 1 1; 5 5 5 4 4 1 1 1; 6 5 5 5 2 1 1 1; 6 5 5 5 4 1 1 1; 8 5 5 5 2 1 1 1; 5 5 5 3 2 2 1 1; 5 5 5 4 3 2 1 1; 5 5 5 4 4 3 1 1; 6 5 5 5 3 2 1 1; 5 5 5 3 3 2 2 1; 5 5 5 4 3 3 2 1; 5 5 5 3 3 3 2 2; 5 5 5 5 2 2 1 1; 5 5 5 5 4 2 1 1; 5 5 5 5 3 2 2 1; 7 2 2 1 1 1 1 1; 7 4 2 1 1 1 1 1; 7 4 4 1 1 1 1 1; 7 6 2 1 1 1 1 1; 7 6 4 1 1 1 1 1; 7 6 6 1 1 1 1 1; 8 7 2 1 1 1 1 1; 8 7 4 1 1 1 1 1; 8 7 6 1 1 1 1 1; 8 8 7 1 1 1 1 1; 10 7 2 1 1 1 1 1; 10 7 4 1 1 1 1 1; 10 7 6 1 1 1 1 1; 12 7 2 1 1 1 1 1; 12 7 4 1 1 1 1 1; 14 7 2 1 1 1 1 1; 7 3 2 2 1 1 1 1; 7 4 3 2 1 1 1 1; 7 4 4 3 1 1 1 1; 7 6 3 2 1 1 1 1; 7 6 4 3 1 1 1 1; 7 6 6 3 1 1 1 1; 8 7 3 2 1 1 1 1; 8 7 4 3 1 1 1 1; 8 7 6 3 1 1 1 1; 10 7 3 2 1 1 1 1; 10 7 4 3 1 1 1 1; 12 7 3 2 1 1 1 1; 7 3 3 2 2 1 1 1; 7 4 3 3 2 1 1 1; 7 4 4 3 3 1 1 1; 7 6 3 3 2 1 1 1; 7 6 4 3 3 1 1 1; 7 6 6 3 3 1 1 1; 8 7 3 3 2 1 1 1; 8 7 4 3 3 1 1 1; 10 7 3 3 2 1 1 1; 7 3 3 3 2 2 1 1; 7 4 3 3 3 2 1 1; 7 4 4 3 3 3 1 1; 7 6 3 3 3 2 1 1; 7 6 4 3 3 3 1 1; 8 7 3 3 3 2 1 1; 7 3 3 3 3 2 2 1; 7 4 3 3 3 3 2 1; 7 4 4 3 3 3 3 1; 7 6 3 3 3 3 2 1; 7 3 3 3 3 3 2 2; 7 4 3 3 3 3 3 2; 7 5 2 2 1 1 1 1; 7 5 4 2 1 1 1 1; 7 5 4 4 1 1 1 1; 7 6 5 2 1 1 1 1; 7 6 5 4 1 1 1 1; 7 6 6 5 1 1 1 1; 8 7 5 2 1 1 1 1; 8 7 5 4 1 1 1 1; 10 7 5 2 1 1 1 1; 7 5 3 2 2 1 1 1; 7 5 4 3 2 1 1 1; 7 5 4 4 3 1 1 1; 7 6 5 3 2 1 1 1; 7 6 5 4 3 1 1 1; 8 7 5 3 2 1 1 1; 7 5 3 3 2 2 1 1; 7 5 4 3 3 2 1 1; 7 5 4 4 3 3 1 1; 7 6 5 3 3 2 1 1; 7 5 3 3 3 2 2 1; 7 5 4 3 3 3 2 1; 7 5 3 3 3 3 2 2; 7 5 5 2 2 1 1 1; 7 5 5 4 2 1 1 1; 7 5 5 4 4 1 1 1; 7 6 5 5 2 1 1 1; 7 5 5 3 2 2 1 1; 7 5 5 4 3 2 1 1; 7 5 5 3 3 2 2 1; 7 5 5 5 2 2 1 1; 7 7 2 2 1 1 1 1; 7 7 4 2 1 1 1 1; 7 7 4 4 1 1 1 1; 7 7 6 2 1 1 1 1; 7 7 6 4 1 1 1 1; 8 7 7 2 1 1 1 1; 7 7 3 2 2 1 1 1; 7 7 4 3 2 1 1 1; 7 7 4 4 3 1 1 1; 7 7 6 3 2 1 1 1; 7 7 3 3 2 2 1 1; 7 7 4 3 3 2 1 1; 7 7 3 3 3 2 2 1; 7 7 5 2 2 1 1 1; 7 7 5 4 2 1 1 1; 7 7 5 3 2 2 1 1; 7 7 7 2 2 1 1 1; 9 2 2 1 1 1 1 1; 9 4 2 1 1 1 1 1; 9 4 4 1 1 1 1 1; 9 6 2 1 1 1 1 1; 9 6 4 1 1 1 1 1; 9 6 6 1 1 1 1 1; 9 8 2 1 1 1 1 1; 9 8 4 1 1 1 1 1; 9 8 6 1 1 1 1 1; 10 9 2 1 1 1 1 1; 10 9 4 1 1 1 1 1; 12 9 2 1 1 1 1 1; 9 3 2 2 1 1 1 1; 9 4 3 2 1 1 1 1; 9 4 4 3 1 1 1 1; 9 6 3 2 1 1 1 1; 9 6 4 3 1 1 1 1; 9 6 6 3 1 1 1 1; 9 8 3 2 1 1 1 1; 9 8 4 3 1 1 1 1; 10 9 3 2 1 1 1 1; 9 3 3 2 2 1 1 1; 9 4 3 3 2 1 1 1; 9 4 4 3 3 1 1 1; 9 6 3 3 2 1 1 1; 9 6 4 3 3 1 1 1; 9 8 3 3 2 1 1 1; 9 3 3 3 2 2 1 1; 9 4 3 3 3 2 1 1; 9 4 4 3 3 3 1 1; 9 6 3 3 3 2 1 1; 9 3 3 3 3 2 2 1; 9 4 3 3 3 3 2 1; 9 3 3 3 3 3 2 2; 9 5 2 2 1 1 1 1; 9 5 4 2 1 1 1 1; 9 5 4 4 1 1 1 1; 9 6 5 2 1 1 1 1; 9 6 5 4 1 1 1 1; 9 8 5 2 1 1 1 1; 9 5 3 2 2 1 1 1; 9 5 4 3 2 1 1 1; 9 5 4 4 3 1 1 1; 9 6 5 3 2 1 1 1; 9 5 3 3 2 2 1 1; 9 5 4 3 3 2 1 1; 9 5 3 3 3 2 2 1; 9 5 5 2 2 1 1 1; 9 5 5 4 2 1 1 1; 9 5 5 3 2 2 1 1; 9 7 2 2 1 1 1 1; 9 7 4 2 1 1 1 1; 9 7 4 4 1 1 1 1; 9 7 6 2 1 1 1 1; 9 7 3 2 2 1 1 1; 9 7 4 3 2 1 1 1; 9 7 3 3 2 2 1 1; 9 7 5 2 2 1 1 1; 9 9 2 2 1 1 1 1; 9 9 4 2 1 1 1 1; 9 9 3 2 2 1 1 1; 11 2 2 1 1 1 1 1; 11 4 2 1 1 1 1 1; 11 4 4 1 1 1 1 1; 11 6 2 1 1 1 1 1; 11 6 4 1 1 1 1 1; 11 6 6 1 1 1 1 1; 11 8 2 1 1 1 1 1; 11 8 4 1 1 1 1 1; 11 10 2 1 1 1 1 1; 11 3 2 2 1 1 1 1; 11 4 3 2 1 1 1 1; 11 4 4 3 1 1 1 1; 11 6 3 2 1 1 1 1; 11 6 4 3 1 1 1 1; 11 8 3 2 1 1 1 1; 11 3 3 2 2 1 1 1; 11 4 3 3 2 1 1 1; 11 4 4 3 3 1 1 1; 11 6 3 3 2 1 1 1; 11 3 3 3 2 2 1 1; 11 4 3 3 3 2 1 1; 11 3 3 3 3 2 2 1; 11 5 2 2 1 1 1 1; 11 5 4 2 1 1 1 1; 11 5 4 4 1 1 1 1; 11 6 5 2 1 1 1 1; 11 5 3 2 2 1 1 1; 11 5 4 3 2 1 1 1; 11 5 3 3 2 2 1 1; 11 5 5 2 2 1 1 1; 11 7 2 2 1 1 1 1; 11 7 4 2 1 1 1 1; 11 7 3 2 2 1 1 1; 11 9 2 2 1 1 1 1; 13 2 2 1 1 1 1 1; 13 4 2 1 1 1 1 1; 13 4 4 1 1 1 1 1; 13 6 2 1 1 1 1 1; 13 6 4 1 1 1 1 1; 13 8 2 1 1 1 1 1; 13 3 2 2 1 1 1 1; 13 4 3 2 1 1 1 1; 13 4 4 3 1 1 1 1; 13 6 3 2 1 1 1 1; 13 3 3 2 2 1 1 1; 13 4 3 3 2 1 1 1; 13 3 3 3 2 2 1 1; 13 5 2 2 1 1 1 1; 13 5 4 2 1 1 1 1; 13 5 3 2 2 1 1 1; 13 7 2 2 1 1 1 1; 15 2 2 1 1 1 1 1; 15 4 2 1 1 1 1 1; 15 4 4 1 1 1 1 1; 15 6 2 1 1 1 1 1; 15 3 2 2 1 1 1 1; 15 4 3 2 1 1 1 1; 15 3 3 2 2 1 1 1; 15 5 2 2 1 1 1 1; 17 2 2 1 1 1 1 1; 17 4 2 1 1 1 1 1; 17 3 2 2 1 1 1 1; 19 2 2 1 1 1 1 1]
    dict_truth = Dict([7, 7, 4, 4, 1, 1, 1, 1] => 316, [10, 5, 5, 2, 1, 1, 1, 1] => 195, [8, 5, 3, 3, 3, 2, 1, 1] => 173, [8, 6, 3, 3, 1, 1, 1, 1] => 64, [7, 4, 3, 3, 3, 2, 1, 1] => 273, [9, 4, 3, 3, 2, 1, 1, 1] => 353, [5, 4, 4, 1, 1, 1, 1, 1] => 121, [9, 5, 4, 2, 1, 1, 1, 1] => 366, [8, 6, 5, 1, 1, 1, 1, 1] => 127, [8, 4, 3, 3, 3, 3, 3, 1] => 111, [5, 5, 5, 3, 3, 2, 2, 1] => 229, [8, 5, 5, 4, 1, 1, 1, 1] => 193, [10, 10, 1, 1, 1, 1, 1, 1] => 15, [4, 3, 3, 3, 3, 3, 3, 2] => 114, [10, 6, 3, 3, 3, 1, 1, 1] => 88, [11, 6, 3, 3, 2, 1, 1, 1] => 410, [5, 5, 5, 5, 3, 2, 2, 1] => 234, [11, 3, 2, 2, 1, 1, 1, 1] => 401, [4, 4, 3, 1, 1, 1, 1, 1] => 33, [14, 3, 3, 2, 1, 1, 1, 1] => 73, [8, 7, 4, 1, 1, 1, 1, 1] => 242, [9, 6, 6, 1, 1, 1, 1, 1] => 336, [6, 5, 3, 3, 3, 3, 2, 1] => 179, [7, 3, 3, 3, 3, 3, 2, 2] => 282, [12, 8, 3, 1, 1, 1, 1, 1] => 49, [7, 7, 7, 2, 2, 1, 1, 1] => 330, [9, 4, 4, 3, 3, 1, 1, 1] => 354, [10, 5, 3, 2, 1, 1, 1, 1] => 149, [6, 4, 1, 1, 1, 1, 1, 1] => 5, [6, 6, 3, 3, 3, 3, 3, 1] => 109, [6, 6, 5, 3, 1, 1, 1, 1] => 144, [6, 5, 5, 3, 3, 2, 1, 1] => 210, [8, 8, 3, 3, 3, 1, 1, 1] => 85, [9, 5, 4, 4, 3, 1, 1, 1] => 373, [9, 7, 3, 3, 2, 2, 1, 1] => 387, [9, 9, 3, 2, 2, 1, 1, 1] => 391, [8, 6, 3, 1, 1, 1, 1, 1] => 39, [7, 5, 5, 2, 2, 1, 1, 1] => 306, [5, 5, 3, 3, 3, 2, 2, 1] => 213, [8, 4, 3, 3, 1, 1, 1, 1] => 63, [6, 5, 5, 5, 3, 2, 1, 1] => 228, [6, 6, 5, 5, 1, 1, 1, 1] => 191, [10, 7, 6, 1, 1, 1, 1, 1] => 247, [7, 7, 6, 3, 2, 1, 1, 1] => 323, [10, 9, 2, 1, 1, 1, 1, 1] => 340, [12, 5, 3, 3, 2, 1, 1, 1] => 166, [11, 4, 3, 3, 2, 1, 1, 1] => 408, [10, 4, 3, 3, 3, 1, 1, 1] => 87, [11, 5, 4, 2, 1, 1, 1, 1] => 415, [5, 4, 2, 1, 1, 1, 1, 1] => 120, [9, 5, 2, 2, 1, 1, 1, 1] => 365, [7, 7, 3, 3, 3, 2, 2, 1] => 326, [6, 5, 3, 3, 3, 2, 1, 1] => 170, [6, 6, 3, 3, 1, 1, 1, 1] => 61, [17, 2, 2, 1, 1, 1, 1, 1] => 451, [12, 3, 3, 3, 3, 2, 1, 1] => 103, [4, 3, 3, 2, 1, 1, 1, 1] => 57, [6, 6, 5, 1, 1, 1, 1, 1] => 124, [7, 5, 3, 2, 2, 1, 1, 1] => 293, [9, 6, 3, 3, 3, 2, 1, 1] => 361, [8, 3, 3, 3, 3, 3, 3, 2] => 118, [6, 4, 3, 3, 3, 3, 3, 1] => 108, [9, 4, 3, 3, 3, 3, 2, 1] => 363, [8, 4, 3, 1, 1, 1, 1, 1] => 38, [6, 5, 5, 4, 1, 1, 1, 1] => 190, [11, 6, 6, 1, 1, 1, 1, 1] => 397, [12, 7, 3, 2, 1, 1, 1, 1] => 262, [11, 4, 4, 3, 3, 1, 1, 1] => 409, [7, 6, 6, 3, 3, 1, 1, 1] => 268, [8, 7, 2, 1, 1, 1, 1, 1] => 241, [9, 3, 3, 2, 2, 1, 1, 1] => 352, [9, 6, 5, 4, 1, 1, 1, 1] => 369, [9, 8, 5, 2, 1, 1, 1, 1] => 370, [12, 6, 1, 1, 1, 1, 1, 1] => 18, [15, 4, 4, 1, 1, 1, 1, 1] => 445, [3, 3, 3, 3, 2, 2, 1, 1] => 92, [16, 3, 2, 1, 1, 1, 1, 1] => 53, [13, 5, 3, 2, 2, 1, 1, 1] => 441, [5, 5, 4, 3, 3, 3, 3, 2] => 218, [10, 3, 2, 1, 1, 1, 1, 1] => 41, [6, 6, 3, 1, 1, 1, 1, 1] => 36, [10, 5, 4, 3, 1, 1, 1, 1] => 150, [5, 4, 4, 3, 3, 3, 1, 1] => 169, [6, 4, 3, 3, 1, 1, 1, 1] => 60, [9, 7, 4, 4, 1, 1, 1, 1] => 383, [5, 3, 2, 2, 1, 1, 1, 1] => 139, [15, 6, 2, 1, 1, 1, 1, 1] => 446, [5, 5, 4, 4, 3, 3, 1, 1] => 209, [9, 4, 3, 3, 3, 2, 1, 1] => 359, [11, 5, 2, 2, 1, 1, 1, 1] => 414, [5, 5, 5, 4, 2, 1, 1, 1] => 220, [9, 8, 3, 2, 1, 1, 1, 1] => 349, [14, 5, 3, 2, 1, 1, 1, 1] => 154, [4, 4, 3, 3, 3, 3, 1, 1] => 94, [8, 3, 3, 2, 1, 1, 1, 1] => 62, [7, 5, 3, 3, 3, 3, 2, 2] => 305, [10, 10, 3, 1, 1, 1, 1, 1] => 45, [7, 3, 3, 3, 2, 2, 1, 1] => 272, [8, 8, 7, 1, 1, 1, 1, 1] => 244, [12, 4, 1, 1, 1, 1, 1, 1] => 17, [18, 4, 1, 1, 1, 1, 1, 1] => 29, [8, 7, 5, 3, 2, 1, 1, 1] => 298, [6, 3, 3, 3, 3, 3, 3, 2] => 116, [8, 6, 3, 3, 3, 3, 1, 1] => 100, [10, 5, 4, 1, 1, 1, 1, 1] => 130, [9, 3, 3, 3, 3, 3, 2, 2] => 364, [11, 3, 3, 2, 2, 1, 1, 1] => 407, [7, 5, 4, 3, 2, 1, 1, 1] => 294, [7, 7, 5, 4, 2, 1, 1, 1] => 328, [6, 4, 3, 1, 1, 1, 1, 1] => 35, [5, 4, 3, 3, 2, 1, 1, 1] => 156, [10, 8, 1, 1, 1, 1, 1, 1] => 14, [5, 5, 4, 2, 1, 1, 1, 1] => 187, [13, 3, 3, 3, 2, 2, 1, 1] => 438, [7, 6, 5, 2, 1, 1, 1, 1] => 287, [9, 5, 5, 2, 2, 1, 1, 1] => 378, [15, 4, 2, 1, 1, 1, 1, 1] => 444, [12, 6, 3, 3, 1, 1, 1, 1] => 72, [11, 4, 3, 3, 3, 2, 1, 1] => 412, [8, 7, 3, 3, 2, 1, 1, 1] => 269, [12, 6, 5, 1, 1, 1, 1, 1] => 135, [7, 4, 3, 3, 3, 3, 3, 2] => 283, [6, 6, 5, 3, 3, 3, 1, 1] => 172, [7, 7, 4, 2, 1, 1, 1, 1] => 315, [5, 4, 4, 3, 3, 1, 1, 1] => 157, [8, 6, 5, 3, 3, 1, 1, 1] => 163, [16, 2, 1, 1, 1, 1, 1, 1] => 25, [11, 8, 3, 2, 1, 1, 1, 1] => 406, [3, 2, 2, 1, 1, 1, 1, 1] => 31, [8, 4, 3, 3, 3, 3, 1, 1] => 99, [5, 5, 4, 4, 3, 1, 1, 1] => 200, [7, 6, 5, 4, 3, 1, 1, 1] => 297, [7, 6, 3, 2, 1, 1, 1, 1] => 254, [8, 7, 7, 2, 1, 1, 1, 1] => 319, [9, 5, 3, 2, 2, 1, 1, 1] => 371, [10, 2, 1, 1, 1, 1, 1, 1] => 11, [10, 3, 3, 3, 2, 1, 1, 1] => 86, [8, 5, 5, 2, 1, 1, 1, 1] => 192, [6, 3, 3, 2, 1, 1, 1, 1] => 59, [16, 5, 2, 1, 1, 1, 1, 1] => 138, [14, 3, 2, 1, 1, 1, 1, 1] => 50, [4, 4, 3, 3, 3, 1, 1, 1] => 78, [12, 7, 4, 1, 1, 1, 1, 1] => 249, [5, 5, 5, 4, 3, 3, 2, 1] => 230, [7, 5, 5, 3, 2, 2, 1, 1] => 310, [9, 8, 4, 3, 1, 1, 1, 1] => 350, [8, 7, 4, 3, 3, 1, 1, 1] => 270, [15, 3, 2, 2, 1, 1, 1, 1] => 447, [8, 7, 6, 3, 1, 1, 1, 1] => 259, [13, 8, 2, 1, 1, 1, 1, 1] => 431, [10, 5, 2, 1, 1, 1, 1, 1] => 129, [12, 6, 3, 1, 1, 1, 1, 1] => 48, [7, 5, 5, 5, 2, 2, 1, 1] => 313, [6, 6, 3, 3, 3, 3, 1, 1] => 97, [7, 7, 6, 4, 1, 1, 1, 1] => 318, [7, 7, 4, 4, 3, 1, 1, 1] => 322, [12, 4, 3, 3, 1, 1, 1, 1] => 71, [5, 5, 2, 2, 1, 1, 1, 1] => 186, [11, 5, 5, 2, 2, 1, 1, 1] => 421, [8, 6, 3, 3, 3, 1, 1, 1] => 84, [13, 6, 3, 2, 1, 1, 1, 1] => 435, [11, 10, 2, 1, 1, 1, 1, 1] => 400, [7, 2, 2, 1, 1, 1, 1, 1] => 235, [7, 5, 4, 3, 3, 3, 2, 1] => 304, [6, 5, 5, 4, 3, 3, 1, 1] => 211, [5, 4, 3, 3, 3, 3, 2, 1] => 177, [10, 8, 3, 3, 1, 1, 1, 1] => 69, [8, 5, 5, 4, 3, 1, 1, 1] => 205, [8, 5, 3, 2, 1, 1, 1, 1] => 145, [7, 4, 3, 2, 1, 1, 1, 1] => 252, [7, 5, 3, 3, 2, 2, 1, 1] => 299, [10, 8, 5, 1, 1, 1, 1, 1] => 132, [5, 3, 3, 2, 2, 1, 1, 1] => 155, [9, 8, 4, 1, 1, 1, 1, 1] => 338, [14, 5, 4, 1, 1, 1, 1, 1] => 137, [5, 5, 5, 4, 3, 2, 1, 1] => 226, [7, 7, 2, 2, 1, 1, 1, 1] => 314, [19, 2, 2, 1, 1, 1, 1, 1] => 454, [8, 7, 6, 1, 1, 1, 1, 1] => 243, [3, 3, 3, 3, 3, 2, 2, 1] => 104, [4, 3, 2, 1, 1, 1, 1, 1] => 32, [6, 5, 3, 3, 3, 3, 3, 2] => 185, [14, 8, 1, 1, 1, 1, 1, 1] => 24, [11, 5, 3, 2, 2, 1, 1, 1] => 418, [13, 2, 2, 1, 1, 1, 1, 1] => 426, [9, 3, 3, 3, 2, 2, 1, 1] => 358, [6, 6, 5, 3, 3, 1, 1, 1] => 160, [20, 2, 1, 1, 1, 1, 1, 1] => 30, [12, 4, 3, 1, 1, 1, 1, 1] => 47, [17, 4, 2, 1, 1, 1, 1, 1] => 452, [6, 4, 3, 3, 3, 3, 1, 1] => 96, [13, 4, 3, 2, 1, 1, 1, 1] => 433, [8, 4, 3, 3, 3, 1, 1, 1] => 83, [10, 5, 5, 3, 2, 1, 1, 1] => 206, [12, 7, 2, 1, 1, 1, 1, 1] => 248, [6, 6, 5, 5, 3, 1, 1, 1] => 203, [13, 7, 2, 2, 1, 1, 1, 1] => 442, [7, 5, 4, 3, 3, 2, 1, 1] => 300, [7, 6, 4, 3, 1, 1, 1, 1] => 255, [9, 5, 4, 3, 2, 1, 1, 1] => 372, [6, 5, 5, 2, 1, 1, 1, 1] => 189, [5, 4, 3, 3, 3, 2, 1, 1] => 168, [10, 8, 3, 1, 1, 1, 1, 1] => 44, [10, 3, 3, 3, 3, 3, 2, 1] => 112, [7, 4, 4, 3, 3, 3, 3, 1] => 280, [9, 6, 5, 2, 1, 1, 1, 1] => 368, [2, 2, 1, 1, 1, 1, 1, 1] => 1, [7, 3, 3, 3, 3, 2, 2, 1] => 278, [6, 6, 3, 3, 3, 1, 1, 1] => 81, [14, 2, 1, 1, 1, 1, 1, 1] => 21, [14, 3, 3, 3, 2, 1, 1, 1] => 91, [10, 7, 5, 2, 1, 1, 1, 1] => 292, [8, 7, 3, 3, 3, 2, 1, 1] => 277, [10, 5, 3, 3, 2, 1, 1, 1] => 164, [9, 7, 4, 2, 1, 1, 1, 1] => 382, [5, 3, 3, 3, 3, 3, 2, 2] => 182, [11, 8, 4, 1, 1, 1, 1, 1] => 399, [6, 5, 5, 4, 3, 1, 1, 1] => 202, [6, 5, 3, 2, 1, 1, 1, 1] => 142, [9, 8, 2, 1, 1, 1, 1, 1] => 337, [14, 5, 2, 1, 1, 1, 1, 1] => 136, [12, 3, 3, 2, 1, 1, 1, 1] => 70, [17, 3, 2, 2, 1, 1, 1, 1] => 453, [7, 6, 4, 1, 1, 1, 1, 1] => 239, [8, 3, 2, 1, 1, 1, 1, 1] => 37, [8, 5, 4, 3, 1, 1, 1, 1] => 146, [5, 5, 5, 2, 2, 1, 1, 1] => 219, [7, 4, 4, 3, 1, 1, 1, 1] => 253, [8, 7, 5, 4, 1, 1, 1, 1] => 291, [10, 3, 3, 3, 3, 2, 1, 1] => 101, [9, 6, 3, 2, 1, 1, 1, 1] => 346, [11, 3, 3, 3, 2, 2, 1, 1] => 411, [15, 5, 2, 2, 1, 1, 1, 1] => 450, [7, 5, 4, 4, 1, 1, 1, 1] => 286, [9, 5, 5, 3, 2, 2, 1, 1] => 380, [11, 5, 4, 3, 2, 1, 1, 1] => 419, [10, 5, 4, 3, 3, 1, 1, 1] => 165, [7, 5, 5, 4, 4, 1, 1, 1] => 308, [16, 6, 1, 1, 1, 1, 1, 1] => 27, [10, 7, 3, 2, 1, 1, 1, 1] => 260, [13, 6, 4, 1, 1, 1, 1, 1] => 430, [6, 4, 3, 3, 3, 1, 1, 1] => 80, [13, 4, 4, 3, 1, 1, 1, 1] => 434, [11, 6, 5, 2, 1, 1, 1, 1] => 417, [15, 3, 3, 2, 2, 1, 1, 1] => 449, [7, 7, 5, 2, 2, 1, 1, 1] => 327, [4, 2, 1, 1, 1, 1, 1, 1] => 2, [4, 3, 3, 3, 2, 1, 1, 1] => 77, [10, 6, 1, 1, 1, 1, 1, 1] => 13, [5, 5, 5, 5, 4, 2, 1, 1] => 233, [6, 5, 4, 3, 3, 3, 3, 1] => 180, [9, 2, 2, 1, 1, 1, 1, 1] => 331, [5, 5, 3, 2, 2, 1, 1, 1] => 198, [8, 5, 4, 1, 1, 1, 1, 1] => 126, [7, 4, 4, 1, 1, 1, 1, 1] => 237, [9, 4, 3, 2, 1, 1, 1, 1] => 344, [7, 5, 5, 3, 3, 2, 2, 1] => 312, [9, 5, 3, 3, 2, 2, 1, 1] => 375, [8, 8, 1, 1, 1, 1, 1, 1] => 10, [11, 7, 4, 2, 1, 1, 1, 1] => 423, [9, 7, 2, 2, 1, 1, 1, 1] => 381, [11, 8, 2, 1, 1, 1, 1, 1] => 398, [5, 5, 5, 3, 3, 3, 2, 2] => 231, [7, 6, 2, 1, 1, 1, 1, 1] => 238, [7, 7, 3, 2, 2, 1, 1, 1] => 320, [11, 6, 3, 2, 1, 1, 1, 1] => 404, [16, 4, 1, 1, 1, 1, 1, 1] => 26, [13, 4, 4, 1, 1, 1, 1, 1] => 428, [12, 5, 5, 2, 1, 1, 1, 1] => 197, [6, 3, 2, 1, 1, 1, 1, 1] => 34, [6, 5, 4, 3, 1, 1, 1, 1] => 143, [10, 4, 1, 1, 1, 1, 1, 1] => 12, [10, 6, 5, 3, 1, 1, 1, 1] => 151, [9, 5, 4, 3, 3, 2, 1, 1] => 376, [9, 6, 4, 3, 1, 1, 1, 1] => 347, [7, 5, 3, 3, 3, 2, 2, 1] => 303, [12, 10, 1, 1, 1, 1, 1, 1] => 20, [9, 8, 3, 3, 2, 1, 1, 1] => 357, [13, 6, 2, 1, 1, 1, 1, 1] => 429, [8, 2, 1, 1, 1, 1, 1, 1] => 7, [8, 3, 3, 3, 2, 1, 1, 1] => 82, [8, 8, 5, 3, 1, 1, 1, 1] => 148, [5, 4, 4, 3, 3, 3, 3, 3] => 184, [6, 5, 5, 5, 4, 1, 1, 1] => 223, [7, 7, 6, 2, 1, 1, 1, 1] => 317, [11, 2, 2, 1, 1, 1, 1, 1] => 392, [5, 5, 3, 3, 3, 3, 2, 2] => 217, [9, 3, 3, 3, 3, 2, 2, 1] => 362, [10, 7, 4, 3, 1, 1, 1, 1] => 261, [5, 3, 3, 3, 2, 2, 1, 1] => 167, [12, 5, 3, 2, 1, 1, 1, 1] => 152, [8, 5, 2, 1, 1, 1, 1, 1] => 125, [7, 4, 2, 1, 1, 1, 1, 1] => 236, [11, 4, 3, 2, 1, 1, 1, 1] => 402, [7, 6, 4, 3, 3, 3, 1, 1] => 276, [11, 5, 3, 3, 2, 2, 1, 1] => 420, [4, 3, 3, 3, 3, 3, 2, 1] => 105, [10, 6, 3, 3, 1, 1, 1, 1] => 68, [10, 5, 3, 3, 3, 2, 1, 1] => 175, [6, 5, 4, 1, 1, 1, 1, 1] => 123, [11, 7, 2, 2, 1, 1, 1, 1] => 422, [4, 4, 3, 3, 3, 3, 3, 3] => 115, [10, 6, 5, 1, 1, 1, 1, 1] => 131, [5, 5, 4, 3, 2, 1, 1, 1] => 199, [7, 6, 5, 3, 2, 1, 1, 1] => 296, [3, 3, 2, 2, 1, 1, 1, 1] => 56, [9, 6, 4, 1, 1, 1, 1, 1] => 335, [9, 4, 4, 3, 1, 1, 1, 1] => 345, [12, 9, 2, 1, 1, 1, 1, 1] => 342, [10, 5, 5, 4, 1, 1, 1, 1] => 196, [14, 6, 1, 1, 1, 1, 1, 1] => 23, [7, 6, 5, 5, 2, 1, 1, 1] => 309, [8, 8, 3, 3, 1, 1, 1, 1] => 65, [9, 5, 4, 4, 1, 1, 1, 1] => 367, [12, 4, 3, 3, 3, 1, 1, 1] => 90, [13, 4, 2, 1, 1, 1, 1, 1] => 427, [8, 8, 5, 1, 1, 1, 1, 1] => 128, [10, 7, 4, 1, 1, 1, 1, 1] => 246, [11, 6, 4, 3, 1, 1, 1, 1] => 405, [7, 7, 4, 3, 2, 1, 1, 1] => 321, [5, 4, 3, 3, 3, 3, 3, 2] => 183, [9, 7, 5, 2, 2, 1, 1, 1] => 388, [4, 3, 3, 3, 3, 2, 1, 1] => 93, [10, 6, 3, 1, 1, 1, 1, 1] => 43, [8, 5, 4, 3, 3, 3, 1, 1] => 174, [7, 4, 4, 3, 3, 3, 1, 1] => 274, [7, 6, 3, 3, 2, 1, 1, 1] => 266, [10, 4, 3, 3, 1, 1, 1, 1] => 67, [7, 3, 2, 2, 1, 1, 1, 1] => 251, [9, 8, 6, 1, 1, 1, 1, 1] => 339, [7, 5, 4, 4, 3, 3, 1, 1] => 301, [11, 3, 3, 3, 3, 2, 2, 1] => 413, [6, 2, 1, 1, 1, 1, 1, 1] => 4, [6, 3, 3, 3, 2, 1, 1, 1] => 79, [8, 5, 5, 3, 2, 1, 1, 1] => 204, [9, 9, 4, 2, 1, 1, 1, 1] => 390, [9, 4, 4, 1, 1, 1, 1, 1] => 333, [7, 5, 5, 4, 2, 1, 1, 1] => 307, [8, 8, 3, 1, 1, 1, 1, 1] => 40, [8, 3, 3, 3, 3, 3, 2, 1] => 110, [5, 5, 5, 3, 2, 2, 1, 1] => 225, [14, 4, 1, 1, 1, 1, 1, 1] => 22, [8, 5, 5, 5, 2, 1, 1, 1] => 224, [6, 5, 2, 1, 1, 1, 1, 1] => 122, [12, 3, 2, 1, 1, 1, 1, 1] => 46, [11, 6, 4, 1, 1, 1, 1, 1] => 396, [12, 5, 4, 3, 1, 1, 1, 1] => 153, [13, 3, 2, 2, 1, 1, 1, 1] => 432, [5, 5, 5, 5, 2, 2, 1, 1] => 232, [18, 3, 2, 1, 1, 1, 1, 1] => 55, [7, 6, 4, 3, 3, 1, 1, 1] => 267, [9, 6, 2, 1, 1, 1, 1, 1] => 334, [7, 6, 6, 3, 1, 1, 1, 1] => 256, [9, 7, 3, 2, 2, 1, 1, 1] => 385, [16, 4, 3, 1, 1, 1, 1, 1] => 54, [11, 4, 4, 3, 1, 1, 1, 1] => 403, [11, 5, 4, 4, 1, 1, 1, 1] => 416, [10, 9, 3, 2, 1, 1, 1, 1] => 351, [5, 2, 2, 1, 1, 1, 1, 1] => 119, [8, 7, 5, 2, 1, 1, 1, 1] => 290, [10, 4, 3, 1, 1, 1, 1, 1] => 42, [5, 5, 4, 3, 3, 3, 2, 1] => 214, [8, 5, 3, 3, 2, 1, 1, 1] => 161, [7, 4, 3, 3, 2, 1, 1, 1] => 264, [7, 6, 6, 5, 1, 1, 1, 1] => 289, [7, 7, 5, 3, 2, 2, 1, 1] => 329, [7, 5, 4, 2, 1, 1, 1, 1] => 285, [5, 4, 3, 2, 1, 1, 1, 1] => 140, [10, 7, 2, 1, 1, 1, 1, 1] => 245, [9, 5, 3, 3, 3, 2, 2, 1] => 377, [5, 5, 3, 3, 2, 2, 1, 1] => 207, [8, 3, 3, 3, 3, 2, 1, 1] => 98, [9, 7, 6, 2, 1, 1, 1, 1] => 384, [4, 4, 1, 1, 1, 1, 1, 1] => 3, [12, 5, 4, 1, 1, 1, 1, 1] => 134, [13, 4, 3, 3, 2, 1, 1, 1] => 437, [6, 5, 4, 3, 3, 3, 1, 1] => 171, [5, 5, 5, 4, 4, 3, 1, 1] => 227, [11, 4, 4, 1, 1, 1, 1, 1] => 394, [7, 6, 6, 1, 1, 1, 1, 1] => 240, [9, 9, 2, 2, 1, 1, 1, 1] => 389, [13, 5, 4, 2, 1, 1, 1, 1] => 440, [8, 5, 4, 3, 3, 1, 1, 1] => 162, [7, 4, 4, 3, 3, 1, 1, 1] => 265, [9, 4, 2, 1, 1, 1, 1, 1] => 332, [12, 8, 1, 1, 1, 1, 1, 1] => 19, [8, 7, 3, 2, 1, 1, 1, 1] => 257, [7, 7, 3, 3, 2, 2, 1, 1] => 324, [6, 5, 5, 3, 2, 1, 1, 1] => 201, [7, 6, 3, 3, 3, 3, 2, 1] => 281, [7, 5, 4, 4, 3, 1, 1, 1] => 295, [5, 5, 4, 3, 3, 2, 1, 1] => 208, [16, 3, 3, 2, 1, 1, 1, 1] => 75, [8, 6, 1, 1, 1, 1, 1, 1] => 9, [7, 6, 5, 3, 3, 2, 1, 1] => 302, [9, 6, 5, 3, 2, 1, 1, 1] => 374, [6, 3, 3, 3, 3, 3, 2, 1] => 107, [5, 4, 4, 3, 3, 3, 3, 1] => 178, [6, 5, 5, 5, 2, 1, 1, 1] => 222, [11, 6, 2, 1, 1, 1, 1, 1] => 395, [10, 3, 3, 2, 1, 1, 1, 1] => 66, [11, 7, 3, 2, 2, 1, 1, 1] => 424, [6, 4, 3, 3, 3, 3, 3, 3] => 117, [14, 6, 3, 1, 1, 1, 1, 1] => 52, [3, 3, 3, 2, 2, 1, 1, 1] => 76, [5, 5, 4, 4, 3, 3, 3, 1] => 215, [14, 4, 3, 3, 1, 1, 1, 1] => 74, [5, 3, 3, 3, 3, 2, 2, 1] => 176, [7, 7, 4, 3, 3, 2, 1, 1] => 325, [9, 7, 4, 3, 2, 1, 1, 1] => 386, [7, 5, 2, 2, 1, 1, 1, 1] => 284, [4, 4, 3, 3, 3, 3, 3, 1] => 106, [6, 5, 3, 3, 2, 1, 1, 1] => 158, [12, 2, 1, 1, 1, 1, 1, 1] => 16, [12, 3, 3, 3, 2, 1, 1, 1] => 89, [18, 2, 1, 1, 1, 1, 1, 1] => 28, [7, 6, 3, 3, 3, 2, 1, 1] => 275, [9, 6, 3, 3, 2, 1, 1, 1] => 355, [9, 4, 4, 3, 3, 3, 1, 1] => 360, [8, 5, 3, 3, 3, 3, 2, 1] => 181, [7, 4, 3, 3, 3, 3, 2, 1] => 279, [9, 3, 2, 2, 1, 1, 1, 1] => 343, [5, 4, 4, 3, 1, 1, 1, 1] => 141, [8, 4, 1, 1, 1, 1, 1, 1] => 8, [8, 5, 5, 3, 3, 2, 1, 1] => 212, [6, 3, 3, 3, 3, 2, 1, 1] => 95, [8, 6, 5, 3, 1, 1, 1, 1] => 147, [12, 5, 2, 1, 1, 1, 1, 1] => 133, [11, 9, 2, 2, 1, 1, 1, 1] => 425, [13, 5, 2, 2, 1, 1, 1, 1] => 439, [5, 5, 4, 4, 1, 1, 1, 1] => 188, [7, 3, 3, 2, 2, 1, 1, 1] => 263, [11, 4, 2, 1, 1, 1, 1, 1] => 393, [7, 5, 5, 4, 3, 2, 1, 1] => 311, [7, 6, 5, 4, 1, 1, 1, 1] => 288, [9, 5, 5, 4, 2, 1, 1, 1] => 379, [15, 2, 2, 1, 1, 1, 1, 1] => 443, [14, 4, 3, 1, 1, 1, 1, 1] => 51, [10, 7, 3, 3, 2, 1, 1, 1] => 271, [8, 6, 5, 5, 1, 1, 1, 1] => 194, [6, 5, 4, 3, 3, 1, 1, 1] => 159, [5, 5, 5, 4, 4, 1, 1, 1] => 221, [15, 4, 3, 2, 1, 1, 1, 1] => 448, [4, 4, 3, 3, 1, 1, 1, 1] => 58, [14, 7, 2, 1, 1, 1, 1, 1] => 250, [10, 4, 3, 3, 3, 3, 1, 1] => 102, [9, 6, 4, 3, 3, 1, 1, 1] => 356, [8, 7, 4, 3, 1, 1, 1, 1] => 258, [9, 6, 6, 3, 1, 1, 1, 1] => 348, [6, 6, 1, 1, 1, 1, 1, 1] => 6, [3, 3, 3, 3, 3, 3, 2, 2] => 113, [10, 9, 4, 1, 1, 1, 1, 1] => 341, [13, 3, 3, 2, 2, 1, 1, 1] => 436, [6, 5, 5, 3, 3, 3, 2, 1] => 216)

    @test basis == truth
    @test dict_basis == dict_truth
end

@testset "Basis creation single species fermionic n=6, M=10" begin
    # Define parameters
    n = 6
    M = 10
    # Create basis for bosons
    basis, dict_basis = hc_dv.do_basis([n], M, "fermi")
    # Check if the results are correct

    # Both lengths should be equal
    @test length(basis)/n == length(dict_basis)

    # Ensure energy cutoff
    gs = sum(basis[1, :])
    max_val = maximum(basis[1, :])
    # The sum of the elements in each row of the basis should be less than M + n
    @test sum(M + gs - max_val + 0.5 .> [sum(basis[i,:]) for i in 1:length(dict_basis)]) == length(dict_basis)

    truth = [6 5 4 3 2 1; 7 5 4 3 2 1; 7 6 4 3 2 1; 7 6 5 3 2 1; 7 6 5 4 2 1; 8 5 4 3 2 1; 8 6 4 3 2 1; 8 6 5 3 2 1; 8 7 4 3 2 1; 9 5 4 3 2 1; 9 6 4 3 2 1; 10 5 4 3 2 1]
    dict_truth = Dict([7, 6, 5, 4, 2, 1] => 5, [9, 6, 4, 3, 2, 1] => 11, [8, 7, 4, 3, 2, 1] => 9, [7, 6, 5, 3, 2, 1] => 4, [6, 5, 4, 3, 2, 1] => 1, [9, 5, 4, 3, 2, 1] => 10, [8, 6, 5, 3, 2, 1] => 8, [10, 5, 4, 3, 2, 1] => 12, [7, 6, 4, 3, 2, 1] => 3, [8, 6, 4, 3, 2, 1] => 7, [7, 5, 4, 3, 2, 1] => 2, [8, 5, 4, 3, 2, 1] => 6)

    @test basis == truth
    @test dict_basis == dict_truth
end

@testset "Basis creation two species fermionic n1=6 n2=2, M=10" begin
    # Define parameters
    n1 = 6
    n2 = 2
    M = 10
    # Create basis for bosons
    basis, dict_basis = hc_dv.do_basis([n1, n2], M, "fermi")
    # Check if the results are correct

    # Both lengths should be equal
    @test length(basis)/(n1+n2) == length(dict_basis)


    truth = [11 9 7 5 4 3 2 1; 11 9 7 6 5 3 2 1; 11 9 7 6 5 4 3 1; 11 9 8 7 5 3 2 1; 11 9 8 7 5 4 3 1; 11 9 8 7 6 5 3 1; 11 10 9 7 5 3 2 1; 11 10 9 7 5 4 3 1; 12 11 9 7 5 3 2 1; 13 9 7 5 4 3 2 1; 13 9 7 6 5 3 2 1; 13 9 7 6 5 4 3 1; 13 9 8 7 5 3 2 1; 13 9 8 7 5 4 3 1; 13 10 9 7 5 3 2 1; 13 11 7 5 4 3 2 1; 13 11 7 6 5 3 2 1; 13 11 7 6 5 4 3 1; 13 11 8 7 5 3 2 1; 13 11 9 5 4 3 2 1; 13 11 9 6 5 3 2 1; 13 11 9 7 4 3 2 1; 15 9 7 5 4 3 2 1; 15 9 7 6 5 3 2 1; 15 9 7 6 5 4 3 1; 15 9 8 7 5 3 2 1; 15 11 7 5 4 3 2 1; 15 11 7 6 5 3 2 1; 15 11 9 5 4 3 2 1; 15 13 7 5 4 3 2 1; 17 9 7 5 4 3 2 1; 17 9 7 6 5 3 2 1; 17 11 7 5 4 3 2 1; 19 9 7 5 4 3 2 1]
    dict_truth = Dict([13, 11, 9, 5, 4, 3, 2, 1] => 20, [12, 11, 9, 7, 5, 3, 2, 1] => 9, [11, 9, 7, 6, 5, 3, 2, 1] => 2, [13, 9, 7, 6, 5, 3, 2, 1] => 11, [11, 9, 8, 7, 6, 5, 3, 1] => 6, [15, 11, 7, 5, 4, 3, 2, 1] => 27, [13, 11, 9, 7, 4, 3, 2, 1] => 22, [17, 9, 7, 6, 5, 3, 2, 1] => 32, [13, 11, 7, 5, 4, 3, 2, 1] => 16, [13, 11, 9, 6, 5, 3, 2, 1] => 21, [15, 9, 7, 5, 4, 3, 2, 1] => 23, [19, 9, 7, 5, 4, 3, 2, 1] => 34, [13, 11, 8, 7, 5, 3, 2, 1] => 19, [15, 9, 8, 7, 5, 3, 2, 1] => 26, [11, 9, 8, 7, 5, 4, 3, 1] => 5, [11, 9, 7, 5, 4, 3, 2, 1] => 1, [13, 9, 7, 5, 4, 3, 2, 1] => 10, [13, 9, 8, 7, 5, 4, 3, 1] => 14, [15, 13, 7, 5, 4, 3, 2, 1] => 30, [11, 9, 8, 7, 5, 3, 2, 1] => 4, [13, 9, 8, 7, 5, 3, 2, 1] => 13, [15, 11, 7, 6, 5, 3, 2, 1] => 28, [11, 10, 9, 7, 5, 4, 3, 1] => 8, [13, 11, 7, 6, 5, 4, 3, 1] => 18, [15, 9, 7, 6, 5, 4, 3, 1] => 25, [17, 11, 7, 5, 4, 3, 2, 1] => 33, [15, 11, 9, 5, 4, 3, 2, 1] => 29, [11, 10, 9, 7, 5, 3, 2, 1] => 7, [13, 10, 9, 7, 5, 3, 2, 1] => 15, [13, 11, 7, 6, 5, 3, 2, 1] => 17, [15, 9, 7, 6, 5, 3, 2, 1] => 24, [11, 9, 7, 6, 5, 4, 3, 1] => 3, [13, 9, 7, 6, 5, 4, 3, 1] => 12, [17, 9, 7, 5, 4, 3, 2, 1] => 31)
    @test basis == truth
    @test dict_basis == dict_truth
end